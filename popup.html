<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Kayak ➜ *I Settings</title>
  <style>
    body{ font: 14px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; margin:16px; color:#111;}
    label{ display:block; margin:10px 0 4px; font-weight:600; }
    input[type="text"],
    input[type="number"]{ width:120px; padding:6px 8px; border:1px solid #c7c7c7; border-radius:8px; font-size:14px; box-sizing:border-box; }
    small{ color:#666; }
    .row{ display:flex; gap:12px; align-items:center; }
    button{ margin-top:12px; padding:8px 12px; border-radius:8px; border:1px solid #c7c7c7; background:#fff; cursor:pointer; font-weight:600; }
    .ok{ color:#0a7; margin-left:8px; display:none; font-weight:600; }
    .toggle{ display:flex; align-items:center; gap:8px; margin:18px 0 4px; font-weight:600; }
    .toggle input{ width:auto; margin:0; }
    .toggle-help{ display:block; margin-left:26px; margin-top:-2px; font-size:12px; color:#666; }
    textarea{ width:100%; min-height:140px; padding:8px 10px; border:1px solid #c7c7c7; border-radius:8px; box-sizing:border-box; font: 13px/1.5 "SFMono-Regular","Consolas","Liberation Mono",monospace; resize:vertical; }
    textarea[readonly]{ background:#f8f8f8; color:#222; }
    .converter{ margin-top:22px; padding-top:16px; border-top:1px solid #e6e6e6; }
    .converter .row{ margin-bottom:4px; }
    .converter-actions{ display:flex; gap:10px; align-items:center; margin:12px 0; }
    .converter-actions button{ margin-top:0; }
    .convert-status{ font-size:12px; margin-bottom:8px; color:#0a7; display:none; }
    .convert-error{ font-size:12px; margin-bottom:8px; color:#c0392b; display:none; }
    .converter small{ display:block; margin-top:-6px; margin-bottom:10px; color:#888; }
    #copyBtn:disabled{ opacity:0.5; cursor:default; }
    .auto-detect{ display:flex; align-items:center; gap:12px; margin:6px 0 10px; }
    .auto-detect__note{ font-size:12px; color:#555; flex:1; }
    .link-btn{ border:none; background:none; padding:0; color:#0a7; font-size:12px; font-weight:600; cursor:pointer; text-decoration:underline; }
    .link-btn:disabled{ opacity:0.6; cursor:default; text-decoration:none; }
    .availability-preview{ margin-top:16px; padding:12px 12px 10px; border:1px solid #d8d8d8; border-radius:10px; background:#f8f9fb; display:none; }
    .availability-preview__title{ font-weight:700; margin-bottom:6px; font-size:13px; color:#0a4069; }
    .availability-preview__list{ display:flex; flex-direction:column; gap:6px; }
    .availability-preview__item{ display:grid; grid-template-columns:auto 1fr auto; gap:8px; align-items:center; padding:6px 8px; border-radius:8px; background:#fff; box-shadow:0 1px 2px rgba(9, 19, 33, .08); }
    .availability-preview__label{ font-weight:600; color:#0a4069; font-size:12px; }
    .availability-preview__command{ font:12px/1.4 "SFMono-Regular","Consolas","Liberation Mono",monospace; color:#111; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .availability-preview__copy{ border:none; background:#0a7; color:#fff; font-weight:600; font-size:12px; padding:6px 10px; border-radius:6px; cursor:pointer; }
    .availability-preview__copy:disabled{ opacity:.6; cursor:default; }
    .availability-preview__hint{ display:block; margin-top:8px; font-size:11px; color:#5a6472; }
  </style>
</head>
<body>
  <div class="row">
    <div>
      <label for="bookingClass">Booking class</label>
      <input id="bookingClass" type="text" maxlength="1" placeholder="J" />
      <small>1 letter</small>
    </div>
    <div>
      <label for="segmentStatus">Segment status</label>
      <input id="segmentStatus" type="text" maxlength="3" placeholder="SS1" />
      <small>3 chars</small>
    </div>
  </div>
  <div class="auto-detect">
    <span id="bookingStatusNote" class="auto-detect__note"></span>
    <button id="restoreAutoBtn" type="button" class="link-btn">Restore auto cabin detection</button>
  </div>
  <label class="toggle"><input id="enableDirections" type="checkbox" /> Show availability buttons</label>
  <small class="toggle-help">Adds outbound / inbound (and multi-city journey) availability pills next to *I.</small>
  <button id="saveBtn" type="button">Save</button><span id="ok" class="ok">Saved</span>

  <div class="converter">
    <label for="viInput">VI* itinerary</label>
    <textarea id="viInput" placeholder="Paste Sabre VI* output here"></textarea>
    <div id="availabilityPreview" class="availability-preview">
      <div class="availability-preview__title">Availability commands</div>
      <div id="availabilityList" class="availability-preview__list" role="list"></div>
      <small class="availability-preview__hint">Generated from the VI* text — tap any command to copy it instantly.</small>
    </div>
    <div class="converter-actions">
      <button id="convertBtn" type="button">Convert to *I</button>
      <button id="copyBtn" type="button" disabled>Copy</button>
    </div>
    <div id="convertStatus" class="convert-status"></div>
    <div id="convertError" class="convert-error"></div>
    <label for="iOutput">*I result</label>
    <textarea id="iOutput" readonly placeholder="Converted *I output will appear here"></textarea>
  </div>
  <script src="airlines.js"></script>
  <script src="converter.js"></script>
  <script src="popup.js"></script>
</body>
</html>
